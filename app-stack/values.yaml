app:
  name: app
  image:
    repository: ghcr.io/doda25-team13/app
  port: 8080
  service:
    port: 80
    type: ClusterIP
  resources:
    requests:
      cpu: "50m"
      memory: "64Mi"
    limits:
      cpu: "200m"
      memory: "256Mi"

ingress:
  enabled: true
  className: nginx
  name: app-ingress
  hosts:
    stable: app.stable.example.com

model:
  name: model-service
  image:
    repository: ghcr.io/doda25-team13/model-service
    tag: latest
  port: 8081
  resources:
    requests:
      cpu: "50m"
      memory: "64Mi"
    limits:
      cpu: "200m"
      memory: "256Mi"

secret:
  name: app-secret
  smtpUser: "placeholder-user"
  smtpPass: "placeholder-password"

kube-prometheus-stack:
  prometheusOperator:
    admissionWebhooks:
      patch:
        podAnnotations:
          sidecar.istio.io/inject: "false"
  prometheus:
    prometheusSpec:
      serviceMonitorSelectorNilUsesHelmValues: false
      serviceMonitorSelector: {}
      ruleSelector: {}
      resources:
        requests:
          cpu: "50m"
          memory: "128Mi"
        limits:
          cpu: "500m"
          memory: "512Mi"
  defaultRules:
    create: false

  alertmanager:
    enabled: true
    alertmanagerSpec:
      useExistingSecret: true
      configSecret: alertmanager-config
      resources:
        requests:
          cpu: "50m"
          memory: "64Mi"
        limits:
          cpu: "200m"
          memory: "256Mi"

  # Add custom alert rules
  additionalPrometheusRulesMap:
    app-alerts:
      groups:
        - name: app.rules
          interval: 30s
          rules:
            - alert: HighActiveSessions
              expr: app_active_sessions >= 2
              for: 1m
              labels:
                severity: warning
              annotations:
                summary: "High number of active sessions"
                description: "App has {{ $value }} active sessions (threshold: 2)"
  grafana:
    enabled: true
    adminUser: admin
    adminPassword: admin123

versions:
  app:
    - name: v1
      tag: latest
      weight: 90
    - name: v2
      tag: 1.2.1
      weight: 10
  model:
    - name: v1
      tag: latest
    - name: v2
      tag: latest

ratelimit:
  domain: ratelimit
  global_limit: 100
  user_limit: 10
